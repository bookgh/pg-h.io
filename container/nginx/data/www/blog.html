<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
  </style>
  <title>pg --blog</title>
</head>

<body style="background-color:lightgray;" link="black" vlink="black" alink="black">

  <p>
    date: 20180408
  </p>

  <h1>Prometheus long term retention</h1>
  <p>
    By default, Prometheus time series database (TSDB) is set to keep its collection of data for 15 days (1).
    This is usually enough data for metric based monitoring, but what happens when management wants monthly numbers?
    We can send the Prometheus data into Influx Data's database, InfluxDB.
  </p>
  <p>
    InfluxDB is a TSDB as well. It is based on timestamp=value pairs that are collected within a Measurement.
    A Measurements is similar to a SQL table.
    InfluxDB also has Series. Series are essentially every row, under a Measurement, with the same tags and fields.
    These tags and fields have to have the same values.
    With Prometheus, this concept does transfer one to one so bumping up against InfluxDB defaults can happen depending upon the number of unique items being collected.
  </p>
  <h2>Prometheus</h2>
  <p>
    We can use Prometheus to look at the data with the /graph landing page.
    If we select a metric like "up" we can see the response is:
    <table>
      <tr>
        <td>element</td><td>value</td>
      </tr>
      <tr>
        <td>up{instance="localhost:9090",job="prometheus"}</td><td>1</td>
      </tr>
    </table>
  </p>
  <p>
    The Prometheus graph will show the latest entry for the metric selected unless we pass it an amount of time.
  </p>
  <h2>InfluxDB</h2>
  <p>
    We can interact with InfluxDB by either using "influx" at the CLI or we could use the API to make calls.
    I find interacting with the CLI to be proficient for messing around figuring things out while the API can be programmed... your call.
    <ul style="list-style-type:none">
      <li>$ influx</li>
      <li>> select * from prometheus.autogen.up limit 1</li>
      <li>
        name: up<br>
        time                instance       job        value<br>
        ----                --------       ---        -----<br>
        1523215564367000000 localhost:9090 prometheus 1
      </li>

    </ul>
  </p>
  <h2>Good to knows...</h2>
  <p>
    Bring up InfluxDB running config
    <ul style="list-style-type:none">
      <li>$ influxd config</li>
    </ul>
    Show the InfluxDB stats
    <ul style="list-style-type:none">
      <li>> show stats</li>
    </ul>
  </p>
  <h2>Conclusion</h2>
  <p>
    Prometheus default retention period could be extended to collect data for how ever long you wish.
    But even Prometheus themselves don't recommend keeping data in their database for long.
    They do actually recommend storing it somewhere else for long term retention.
    I'm only appending about 18,000 metric scrapes per second right now (at work), and I'm hitting walls that I have to troubleshoot.
    Using InfluxDB to house long term retention and down sample data has helped out a lot.
    I still use Promethues for about 30 days of 100% of the collection.
  </p>
  <p>
    I will continue to post on this topic and my findings. Sorry for the short post.
  </p>
  <h2>References</h2>
  <p>
    1. <a href="https://prometheus.io/docs/prometheus/latest/storage/#operational-aspects">Prometheus.io</a>
  </p>
  <hr>

  <p>date: 20180401</p>

  <h1>Just put it out there...</h1>
  <p>
    After being a consumer of the internet for so long, thinking to myself I have nothing to offer… but! recently I have been
    told otherwise. I have listened to, or read, podcasts, books, articles and the random assortment of daily internet content,
    which says just put it out there and try to help others. So… maybe I'll find an audience that will find something I put
    out there beneficial.
  </p>

  <h2>Where I'm coming from...</h2>
  <p>
    I like to consider myself a generalist as I don't think I know anything very well, but have a broad knowledge. I have worked
    within the technology world for somewhere around eighteen years. I have worked at tiny companies, large companies, and
    I like the in-between personally. I enjoy working with all of the softwares and not just one or doing the same thing
    every day.
  </p>

  <h2>Where I think I'm going with this...</h2>
  <p>
    I am currently in the pursuit of trying to develop my programming skills, chasing the Go language. I am looking to do this
    while online, giving out anything I learn along the way. I have been running through Todd McLeod’s learn how to program
    class (
    <a href="https://twitter.com/Todd_McLeod/status/976523161985458176" target="_blank">https://twitter.com/Todd_McLeod/status/976523161985458176</a>) when I’m not working or living life. I have been having
    a great time, enough to detour me away from the Udacity scholarship Android class. I don’t like how that class was being
    taught, I feel like Todd does a great job and is more my style of learning. I really enjoy what I’ve used with Go and
    how the community around the language is. I can’t wait to see where this all goes and I hope to fail and learn along
    the way.
  </p>

</body>

</html>
